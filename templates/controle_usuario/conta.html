<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Encontre os melhores trailers de filmes, séries, animes e doramas. Explore lançamentos e produções famosas com uma experiência visual incrível.">
    <meta property="og:title" content="Cinetrailers">
    <meta property="og:description"
        content="Encontre os melhores trailers de filmes, séries, animes e doramas. Explore lançamentos e produções famosas com uma experiência visual incrível.">

    <title>Assistir - Series </title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/controle_usuario/configuracoes.css' %}">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap">
    <link rel="icon" href="{% static 'imagens/favicon cinetrailers.png' %}" type="image/x-icon">
    <link rel="shortcut icon" href="{% static 'imagens/favicon cinetrailers.png' %}" type="image/x-icon">
    <link href="https://fonts.googleapis.com/css2?family=ABeeZee&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Abel&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&display=swap"
        rel="stylesheet">


</head>

<body>
    <header>
        <div class="site-logo">
            <a href="{% url 'index' %}" class="logo-text">CINESPACE</a>
        </div>

        <nav class="nav-menu">
            <ul>
                <li><a href="{% url 'filmes' %}">FILMES</a></li>
                <li><a href="{% url 'series' %}">SERIES</a></li>
                <li><a href="{% url 'animes' %}">ANIMES</a></li>
                <li><a href="{% url 'esportes' %}">SPACE ESPORTES</a></li>
                <li><a href="{% url 'space_music' %}">SPACE MUSIC</a></li>
            </ul>
        </nav>

        <div class="header-icons">
            <a href="{% url 'resultados' %}">
                <div id="search-icon" class="search-icon">
                    <img src="{% static 'imagens/vectores/lupavec.png' %}" alt="Pesquisar">
                </div>
            </a>


            <div id="I.A-icon" class="alert-icon">
                <img src="{% static 'imagens/vectores/spacebot-vec.png' %}" alt="Favoritos">
            </div>


            <div class="profile-header">
                <img id="profileImage" src="{% static 'imagens/default/profile.jpg' %}" alt="Perfil"
                    class="perfil-image">
                <img id="arrowIcon" src="{% static 'imagens/vectores/setaprabaixovec.png' %}" alt="Abrir menu"
                    class="arrow-icon">
                <div class="menu-perfil">
                    <!-- Link para a página inicial (Home) -->
                    <a href="{% url 'cinetrailers' %}" class="menu-item">
                        <img src="{% static 'imagens/vectores/homevec.png' %}" alt="Home">
                        <span class="menu-text">Home</span>
                    </a>

                    <!-- Link para a página de configurações -->
                    <a href="{% url 'conta' %}" class="menu-item">
                        <img src="{% static 'imagens/vectores/configvec.png' %}" alt="Configurações">
                        <span class="menu-text">Configurações</span>
                    </a>

                    <!-- Link para a página de escolher usuário (Trocar Perfil) -->
                    <a href="{% url 'escolherusuario' %}" class="menu-item">
                        <img src="{% static 'imagens/vectores/perfilvec.png' %}" alt="Trocar-Perfil">
                        <span class="menu-text">Trocar Perfil</span>
                    </a>

                    <!-- Link para a página de gerenciar perfis (Editar) -->
                    <a href="{% url 'gerenciar_perfis' %}" class="menu-item">
                        <img src="{% static 'imagens/vectores/lapisvec.png' %}" alt="EditarPerfil">
                        <span class="menu-text">Editar Perfil</span>
                    </a>

                    <!-- Link para a página de ajuda -->
                    <a href="{% url 'ajuda' %}" class="menu-item">
                        <img src="{% static 'imagens/vectores/ajudavec.png' %}" alt="Ajuda">
                        <span class="menu-text">Ajuda</span>
                    </a>

                    <!-- Link para logout -->
                    <a href="{% url 'logout' %}" class="menu-item">
                        <img src="{% static 'imagens/vectores/sairvec.png' %}" alt="Sair">
                        <span class="menu-text">Sair</span>
                    </a>
                </div>
            </div>
    </header>

    <!-- Janela do Chat Bot -->
    <div id="chat-window" class="chat-window">
        <div class="chat-header">
            <h2>SPACE BOT</h2>
            <button id="close-chat">X</button>
        </div>
        <div class="chat-content">
            <!-- Textos acima dos blocos -->
            <div class="chat-texts">
                <h1>SPACE BOT</h1>
                <p class="subtitle">Chat bot</p>
            </div>

            <!-- Blocos de Comando -->
            <div class="blocks">
                <div class="block" id="block-fotos">
                    <img src="{% static 'imagens/spacebot/vectores/fotosvec.png' %}" alt="Ícone Criar"
                        class="block-icon">
                    <p class="block-text">Criar fotos</p>
                </div>
                <div class="block" id="block-textos">
                    <img src="{% static 'imagens/spacebot/vectores/textovec.png' %}" alt="Ícone Texto"
                        class="block-icon">
                    <p class="block-text">Criar textos</p>
                </div>
                <div class="block" id="block-conversar">
                    <img src="{% static 'imagens/spacebot/vectores/conversarvec.png' %}" alt="Ícone Conversar"
                        class="block-icon">
                    <p class="block-text">Conversar</p>
                </div>
                <div class="block" id="block-agendar">
                    <img src="{% static 'imagens/spacebot/vectores/agendavec.png' %}" alt="Ícone Agendar"
                        class="block-icon">
                    <p class="block-text">Agendar</p>
                </div>
            </div>

            <!-- Área do Chat -->
            <div class="chat-container">
                <div class="chat-messages" id="chat-messages">
                    <div class="loading-indicator" id="loading-indicator" style="display: none;">
                        <div class="spinner"></div>
                    </div>
                </div>
            </div>

            <!-- Barra de Mensagens -->
            <div class="message-bar-container">
                <div class="message-bar">
                    <textarea placeholder="Envie sua mensagem" class="message-input" id="userInput"></textarea>
                    <div class="message-icons">
                        <img src="{% static 'imagens/spacebot/vectores/galeriavec.png' %}" alt="Ícone Galeria"
                            class="icon">
                        <div class="divider"></div>
                        <img src="{% static 'imagens/spacebot/vectores/micvec.png' %}" alt="Ícone Microfone"
                            class="icon" id="micButton">
                    </div>
                    <div class="send-button" id="sendButton">
                        <img src="{% static 'imagens/spacebot/vectores/enviarvec.png' %}" alt="Ícone Enviar"
                            class="icon">
                    </div>
                </div>
            </div>
            <!-- Mensagem abaixo da barra de mensagens -->
            <div class="footer-message">
                <p>
                    Esta é apenas uma janela do SPACEBOT. Se quiser ter uma experiência melhor, acesse o <a
                        href="{% url 'spacebot' %}" target="_blank" class="spacebot-link">SPACEBOT</a>.
                </p>
            </div>
        </div>
    </div>






    <!-- Menu de Categorias -->
    <div class="categories-container">
        <div class="categories-menu">
            <!-- Categoria Conta -->
            <div class="category-item">
                <a href="{% url 'conta' %}"
                    class="category-button {% if request.path == '/conta/' %}active{% endif %}">Conta</a>
            </div>

            <!-- Categoria Assinatura -->
            <div class="category-item">
                <a href="{% url 'assinaturas' %}"
                    class="category-button {% if request.path == '/assinaturas/' %}active{% endif %}">Assinatura</a>
            </div>


            <!-- Categoria Ajuda -->
            <div class="category-item">
                <a href="{% url 'ajuda' %}"
                    class="category-button {% if request.path == '/ajuda/' %}active{% endif %}">Ajuda</a>
            </div>
        </div>
    </div>


    <main class="main-content">
        <div class="conta-container">
            <div class="conta-content">
                <!-- Container de mensagens -->
                <!-- Container de mensagens -->
                <!-- Exibe mensagens de erro ou sucesso -->
                <div class="messages">
                    {% if is_conta_page and messages %}
                    {% for message in messages %}
                    {% if "conta" in message.tags %}
                    <div class="{{ message.tags }}">{{ message }}</div>
                    {% endif %}
                    {% endfor %}
                    {% endif %}
                </div>
                <script>
                    // Função para remover mensagens após 5 segundos
                    function removeMessages() {
                        const messages = document.querySelectorAll('.messages div');
                        messages.forEach(message => {
                            setTimeout(() => {
                                message.remove();
                            }, 5000); // 5000ms = 5 segundos
                        });
                    }

                    // Executa a função quando a página carrega
                    window.onload = removeMessages;
                </script>
                <div class="conta-header">
                    <h1 class="conta-title">Conta</h1>
                    <p class="conta-subtitle">Conta vinculada</p>
                </div>

                <!-- Nome de usuário -->
                <div class="conta-info-section">
                    <h3 class="conta-section-title">Nome de usuário</h3>
                    <div class="conta-input-container">
                        <input type="text" class="conta-input" value="{{ user.nome_usuario }}" disabled>
                        <img src="{% static 'imagens/vectores/lapisvec.png' %}" alt="Editar" class="lapis-icon"
                            data-target="nome" style="display: none;">
                    </div>
                </div>

                <!-- Email e Senha -->
                <div class="conta-dupla-input-group">
                    <!-- Email -->
                    <div class="conta-info-section">
                        <h3 class="conta-section-title">Email</h3>
                        <div class="conta-input-container">
                            <input type="email" class="conta-input" value="{{ user.email }}" disabled>
                        </div>
                    </div>

                    <!-- Senha -->
                    <div class="conta-info-section">
                        <h3 class="conta-section-title">Senha</h3>
                        <div class="conta-input-container">
                            <input type="password" class="conta-input" value="*********" disabled>
                            <img src="{% static 'imagens/vectores/lapisvec.png' %}" alt="Editar" class="lapis-icon"
                                data-target="senha" style="display: none;">
                        </div>
                    </div>
                </div>

                <!-- Botão Editar dados pessoais -->
                <div class="conta-info-section">
                    <button id="editar-dados-btn" class="editar-dados-btn">Editar dados</button>
                </div>

                <!-- Gerenciar Dispositivos -->
                <div class="conta-info-section">
                    <h3 class="conta-section-title-2">Gerenciar Dispositivos</h3>
                    <p class="conta-subtitle-2">Este dispositivo</p>
                    <div class="dispositivos-container">
                        {% for dispositivo in dispositivos %}
                        <div
                            class="dispositivo-item {% if forloop.first %}primeiro-dispositivo{% else %}dispositivo-oculto{% endif %}">
                            <div class="dispositivo-info">
                                <img id="icone-sistema-{{ forloop.counter }}" class="dispositivo-icon"
                                    data-sistema="{{ dispositivo.sistema_operacional|lower }}" alt="Ícone do Sistema" />
                                <span class="dispositivo-nome">{{ dispositivo.sistema_operacional }}</span>
                            </div>
                            <div class="dispositivo-usuario">
                                <img src="{% static 'imagens/default/profile.jpg' %}" alt="Perfil" class="perfil-image">
                                <span class="dispositivo-nome">{{ user.nome_usuario }}</span>
                            </div>
                            <span class="dispositivo-data">{{ dispositivo.ultima_data_login|date:"d/m/Y" }}</span>
                            <span class="dispositivo-pais">{{ dispositivo.pais|default:"N/A" }}</span>
                            <div class="dispositivo-acoes">
                                <form method="POST" action="{% url 'remover_dispositivo' dispositivo.id %}">
                                    {% csrf_token %}
                                    <button type="submit" class="apagar-icon">
                                        <img src="{% static 'imagens/vectores/apagarvec.png' %}" alt="Remover">
                                    </button>
                                </form>
                                {% if forloop.first %}
                                <img src="{% static 'imagens/vectores/setaprabaixovec.png' %}" alt="Expandir"
                                    class="seta-icon" onclick="expandirDispositivos()">
                                {% endif %}
                            </div>
                        </div>
                        {% empty %}
                        <p>Nenhum dispositivo registrado.</p>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </main>



    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Botão "Editar dados"
            const editarDadosBtn = document.getElementById("editar-dados-btn");

            // Ícones de lápis
            const lapisIcons = document.querySelectorAll(".lapis-icon");

            // Estado de edição (inicialmente desativado)
            let editMode = false;

            // Função para alternar o modo de edição
            function toggleEditMode() {
                editMode = !editMode; // Alterna entre true e false

                // Mostra ou esconde os ícones de lápis
                lapisIcons.forEach(icon => {
                    icon.style.display = editMode ? "inline-block" : "none";
                });

                // Altera o texto do botão
                editarDadosBtn.textContent = editMode ? "Cancelar edição" : "Editar dados";
            }

            // Adiciona o evento de clique ao botão "Editar dados"
            editarDadosBtn.addEventListener("click", toggleEditMode);
        });
    </script>


    <!-- Modal para editar nome de usuário -->
    <div id="modal-editar-nome" class="modal">
        <div class="login-container">
            <span class="close">&times;</span>
            <h2>Editar Nome de Usuário</h2>
            <form id="form-editar-nome" class="login-form">
                <input type="text" id="novo-nome" name="novo-nome" placeholder="Novo Nome de Usuário" required>
                <input type="password" id="senha-atual-nome" name="senha-atual-nome" placeholder="Senha Atual" required>
                <a href="{% url 'password_reset' %}" class="forgot-password">Esqueceu sua senha?</a>
                <button type="submit" class="botao-entrar">Salvar</button>
            </form>
        </div>
    </div>

    <!-- Modal para editar senha -->
    <div id="modal-editar-senha" class="modal">
        <div class="login-container">
            <span class="close">&times;</span>
            <h2>Editar Senha</h2>
            <form id="form-editar-senha" class="login-form">
                <input type="password" id="senha-atual" name="senha-atual" placeholder="Senha Atual" required>
                <input type="password" id="nova-senha" name="nova-senha" placeholder="Nova Senha" required>
                <input type="password" id="confirmar-senha" name="confirmar-senha" placeholder="Confirmar Nova Senha"
                    required>
                <a href="{% url 'password_reset' %}" class="forgot-password">Esqueceu sua senha?</a>
                <button type="submit" class="botao-entrar">Salvar</button>
            </form>
        </div>
    </div>

    <footer>
        <h2>CINESPACE</h2>
        <div class="footer-content">
            <div>
                <h4>INSTITUCIONAL</h4>
                <p>Sobre nós</p>
                <p>Termos de uso</p>
                <p>Política de privacidade</p>
            </div>
            <div>
                <h4>SUPORTE</h4>
                <p>Ajuda</p>
                <p>Contato</p>
                <p>FAQ</p>
            </div>
            <div>
                <h4>CONTEÚDO</h4>
                <p>Filmes</p>
                <p>Séries</p>
                <p>Novidades</p>
            </div>
            <div>
                <h4>PARCERIAS</h4>
                <p>Produtoras</p>
                <p>Anunciantes</p>
                <p>Afiliados</p>
            </div>
            <div>
                <h4>ASSINATURA</h4>
                <p>Planos</p>
                <p>Promoções</p>
                <p>Cancelamento</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>English | Português | Español | Français | Italiano | Deutsch | 日本語 | 中文</p>
            <p>&copy; 2025 Cinespace, LLC. Todos os direitos reservados. Todos os elementos pertencem aos seus respectivos proprietários.</p>
        </div>
    </footer>





    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Abrir modal de edição de nome de usuário
            document.querySelector(".lapis-icon[data-target='nome']").addEventListener("click", function () {
                document.getElementById("modal-editar-nome").style.display = "block";
            });

            // Abrir modal de edição de senha
            document.querySelector(".lapis-icon[data-target='senha']").addEventListener("click", function () {
                document.getElementById("modal-editar-senha").style.display = "block";
            });

            // Fechar modais ao clicar no botão de fechar
            document.querySelectorAll(".close").forEach(function (closeBtn) {
                closeBtn.addEventListener("click", function () {
                    this.closest(".modal").style.display = "none";
                });
            });

            // Fechar modais ao clicar fora do conteúdo
            window.addEventListener("click", function (event) {
                if (event.target.classList.contains("modal")) {
                    event.target.style.display = "none";
                }
            });

            // Enviar formulário de edição de nome de usuário
            document.getElementById("form-editar-nome").addEventListener("submit", function (event) {
                event.preventDefault();
                const novoNome = document.getElementById("novo-nome").value;
                const senhaAtual = document.getElementById("senha-atual-nome").value;

                fetch("/editar-nome-usuario/", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "X-CSRFToken": getCookie("csrftoken"),
                    },
                    body: JSON.stringify({
                        novo_nome: novoNome,
                        senha_atual: senhaAtual,
                    }),
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            alert("Nome de usuário atualizado com sucesso!");
                            location.reload();
                        } else {
                            alert(data.message);
                        }
                    });
            });

            // Enviar formulário de edição de senha
            document.getElementById("form-editar-senha").addEventListener("submit", function (event) {
                event.preventDefault();
                const senhaAtual = document.getElementById("senha-atual").value;
                const novaSenha = document.getElementById("nova-senha").value;
                const confirmarSenha = document.getElementById("confirmar-senha").value;

                fetch("/editar-senha/", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "X-CSRFToken": getCookie("csrftoken"),
                    },
                    body: JSON.stringify({
                        senha_atual: senhaAtual,
                        nova_senha: novaSenha,
                        confirmar_senha: confirmarSenha,
                    }),
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            // Redireciona para a página de conta
                            window.location.href = data.redirect_url;
                        } else {
                            // Exibe a mensagem de erro no container de mensagens
                            const messagesContainer = document.querySelector(".messages");
                            messagesContainer.innerHTML = `<div class="error">${data.message}</div>`;
                        }
                    });
            });

            // Função para obter o token CSRF
            function getCookie(name) {
                let cookieValue = null;
                if (document.cookie && document.cookie !== '') {
                    const cookies = document.cookie.split(';');
                    for (let i = 0; i < cookies.length; i++) {
                        const cookie = cookies[i].trim();
                        if (cookie.substring(0, name.length + 1) === (name + '=')) {
                            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                            break;
                        }
                    }
                }
                return cookieValue;
            }
        });
    </script>




    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const profileHeader = document.querySelector(".profile-header");
            const menuPerfil = document.querySelector(".menu-perfil");
            let timeoutID;

            profileHeader.addEventListener("click", (event) => {
                event.stopPropagation();
                if (menuPerfil.style.display === "flex") {
                    menuPerfil.style.display = "none";
                } else {
                    menuPerfil.style.display = "flex";
                }
            });

            function fecharMenu() {
                timeoutID = setTimeout(() => {
                    menuPerfil.style.display = "none";
                }, 200);
            }

            profileHeader.addEventListener("mouseleave", fecharMenu);
            menuPerfil.addEventListener("mouseleave", fecharMenu);

            menuPerfil.addEventListener("mouseenter", () => {
                clearTimeout(timeoutID);
            });

            document.addEventListener("click", (event) => {
                if (!profileHeader.contains(event.target) && !menuPerfil.contains(event.target)) {
                    menuPerfil.style.display = "none";
                }
            });
        });
    </script>


    <script src="{% static 'javascripts/config-conta.js' %}"></script>
    <script src="{% static 'javascripts/menu.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/franc@6.1.0/dist/franc.min.js"></script>
    <script src="{% static 'javascripts/chatbot.js' %}"></script>
    <script src="{% static 'javascripts/lupa.js' %}"></script>
    <script src="{% static 'javascripts/header.js' %}"></script>
</body>

</html>